<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.6.0 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Implementing an ERGM from scratch in Python - 计算传播网</title>




<meta name="description" content="I’ve always felt a bit nervous about using them (ERGM), though, because I didn’t feel confident I really understood how they worked, and how they were being estimated. To help with that, I decided I needed to implement a simple toy ERGM from scratch.">




<meta name="author" content="计算传播网">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="计算传播网">
<meta property="og:title" content="Implementing an ERGM from scratch in Python">


  <link rel="canonical" href="https://socrateslab.github.io/forum/ergm-python/">
  <meta property="og:url" content="https://socrateslab.github.io/forum/ergm-python/">



  <meta property="og:description" content="I’ve always felt a bit nervous about using them (ERGM), though, because I didn’t feel confident I really understood how they worked, and how they were being estimated. To help with that, I decided I needed to implement a simple toy ERGM from scratch.">



  <meta name="twitter:site" content="@ChengJunWang">
  <meta name="twitter:title" content="Implementing an ERGM from scratch in Python">
  <meta name="twitter:description" content="I’ve always felt a bit nervous about using them (ERGM), though, because I didn’t feel confident I really understood how they worked, and how they were being estimated. To help with that, I decided I needed to implement a simple toy ERGM from scratch.">
  <meta name="twitter:url" content="https://socrateslab.github.io/ergm-python/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://socrateslab.github.io/forum/assets/images/unsplash-gallery-image-2-th.jpg">
    
  

  
    <meta name="twitter:creator" content="@计算传播网">
  



  

  



  <meta property="og:image" content="https://socrateslab.github.io/forum/assets/images/unsplash-image-20.jpg">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-06-27T00:00:00+00:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "计算传播网",
      "url" : "https://socrateslab.github.io/forum",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://socrateslab.github.io/forum/feed.xml" type="application/atom+xml" rel="alternate" title="计算传播网 Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/forum/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<!--mathjax start-->
    <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         processEscapes: true
       },
      TeX: {
         equationNumbers: { autoNumber: "AMS" }
      }
     });
    </script>
    <script type="text/javascript"
                src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <!--mathjax end-->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="https://socrateslab.github.io/forum/">计算传播网</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io/forum/about/">关于</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io/forum/year-archive/">文章</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io/forum/authors/">作者</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io">中心</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://computational-communication.com/wiki/">百科</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    
  











<div class="page__hero--overlay"
  style="background-color: #000; background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://socrateslab.github.io/forum/assets/images/unsplash-image-20.jpg');"
>
  
    <div class="wrapper">
      <h1 class="page__title" itemprop="headline">
        
          Implementing an ERGM from scratch in Python

        
      </h1>
      
        <p class="page__lead">I’ve always felt a bit nervous about using them (ERGM), though, because I didn’t feel confident I really understood how they worked, and how they were being estimated. To help with that, I decided I needed to implement a simple toy ERGM from scratch.
</p>
      
      
      
    </div>
  
  
    <span class="page__hero-caption">Photo credit: <a href="https://unsplash.com"><strong>Unsplash</strong></a>
</span>
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://socrateslab.github.io/forum/assets/logo.jpg" class="author__avatar" alt="计算传播网" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">计算传播网</h3>
    
      <p class="author__bio" itemprop="description">
        Computational Communication
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Nanjing</span>
        </li>
      

      
        <li>
          <a href="https://computational-communication.com" itemprop="url">
            <i class="fa fa-fw fa-chain" aria-hidden="true"></i> Website
          </a>
        </li>
      

      
        <li>
          <a href="mailto:computational.communication@gmail.com">
            <meta itemprop="email" content="computational.communication@gmail.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.weibo.com/http://weibo.com/p/10080843f915e125a13c116fe1854bc43ccf0a/home" itemprop="sameAs">
            <i class="fa fa-fw fa-weibo" aria-hidden="true"></i> Weibo
          </a>
        </li>
      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Implementing an ERGM from scratch in Python">
    <meta itemprop="description" content="I’ve always felt a bit nervous about using them (ERGM), though, because I didn’t feel confident I really understood how they worked, and how they were being estimated. To help with that, I decided I needed to implement a simple toy ERGM from scratch.">
    <meta itemprop="datePublished" content="June 27, 2017">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        <p><strong>Author</strong>: David Masad</p>

<p>Source: <a href="http://davidmasad.com/blog/ergms-from-scratch/">http://davidmasad.com/blog/ergms-from-scratch/</a></p>

<p>Exponential random graph models (ERGMs) are statistical models for explaining the structure of social and other networks (also called graphs). If we have a network, and some hypotheses about the factors that make it looks the way it does, an ERGM is meant to tell us how big a role (if any) these factors actually play.</p>

<p>I think of it as a regression model: we have several independent variables we think determine the dependent variable, and the model estimates the size and significance of the effect of each.</p>

<p>For someone like me who works a lot with networks, ERGMs can be a very powerful tool. There is even an excellent R package called, appropriately enough, ergm, that makes estimating ERGMs just about as easy as specifying a regression formula.</p>

<p>I’ve always felt a bit nervous about using them, though, because I didn’t feel confident I really understood how they worked, and how they were being estimated.</p>

<h1 id="toy-ergm-from-scratch">Toy ERGM from Scratch</h1>

<p>To help with that, I decided I needed to implement a simple toy ERGM from scratch. It didn’t need to be fast, or really applicable at all. The most important thing was to take the methodology apart and put it back together again.</p>

<p>In this post, I’m going to walk through my implementation of a highly simplified ERGM estimation, using Python and the NetworkX package. I’m hoping that it will help others with similar questions, and that people who know more than I do will point out anything I’m getting wrong.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="n">nx</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
</code></pre></div></div>

<h1 id="graph-probabilities">Graph probabilities</h1>

<p>The basic idea of ERGMs is to define a probability distribution over all possible graphs of a given number of nodes, where the probability of each graph is proportional to some of its network statistics. In this post, the statistics I’ll use throughout are the edge count and the number of triangles, but any network statistics will do. If edge count and triangles have coefficients a and b, then the probability of observing a particular graph G is:</p>

\[Pr(G)∝a∗edges(G)+b∗triangles(G)\]

<p>or more specifically:</p>

\[Pr(G)∝e^{a∗edges(G)+b∗triangles(G)}\]

<p>(hence the exponential).</p>

<p>Think of this as the ‘weight’ we put on a particular network. In Python, this looks like:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">compute_weight</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">tri_coeff</span><span class="p">):</span>
    <span class="s">'''
    Compute the probability weight on graph G
    '''</span>
    <span class="n">edge_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">edges</span><span class="p">())</span>
    <span class="n">triangles</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nx</span><span class="p">.</span><span class="n">triangles</span><span class="p">(</span><span class="n">G</span><span class="p">).</span><span class="n">values</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">edge_count</span> <span class="o">*</span> <span class="n">edge_coeff</span> <span class="o">+</span> <span class="n">triangles</span> <span class="o">*</span> <span class="n">tri_coeff</span><span class="p">)</span>
</code></pre></div></div>

<p>To turn that weight into a probability, we need to normalize it by the weights of all other possible networks. Mathematically:</p>

\[Pr(G)=\frac{exp(a∗edges(G)+b∗triangles(G))}{∑_{g∈G}exp(a∗edges(g)+b∗triangles(g))}\]

<p>Now we come to the first problem: calculating the denominator of that equation. There are many possible graphs. To take the simplest example, an undirected graph with 3 nodes has 8 possible configurations:</p>

<p><img src="https://socrateslab.github.io/forum/assets/img2017/ergm0.png" alt="" /></p>

<p>There are 64 possible configurations for a 4-node graph, and the number of possible configurations grows mind-bogglingly quickly after that. Most of the time, we simply can’t calculate the weights for all possible graphs. Instead, we need some sort of approximation.</p>

<p>We could just generate some large number of random graphs, and use that – but we have no way of knowing how representative they are of the actual distribution. We need a way to generate a sample that we think covers the most probable area of the distribution. In terms of the equation above, we want to sample heavily from networks where the weights are large, and less where the weights are small, so that the sum of the weights of the sample gets as close as possible to the actual total weight. Which brings us to the next step:</p>

<h1 id="markov-chain-monte-carlo">Markov Chain Monte Carlo</h1>

<p>Markov Chain Monte Carlo (MCMC) actually refers a broad class of techniques for generating samples from complicated distributions. For our purposes, it means exploring the space of possible networks, moving toward the ones which are more likely given the distribution coefficients.</p>

<p>We’ll implement a simple version of the Metropolis-Hastings algorithm. We start with some network, and randomly add or subtract an edge.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">permute_graph</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    <span class="s">'''
    Return a new graph with an edge randomly added or subtracted from G
    '''</span>
    <span class="n">G1</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">density</span><span class="p">(</span><span class="n">G1</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="ow">or</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Add an edge
</span>        <span class="n">nodes</span> <span class="o">=</span> <span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">()</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">G1</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Remove an edge
</span>        <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">G1</span><span class="p">.</span><span class="n">edges</span><span class="p">())</span>
        <span class="n">G1</span><span class="p">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">G1</span>

</code></pre></div></div>

<p>After the change, we check the weight on this new network.</p>

<ul>
  <li>If it’s greater than the previous network’s weight (that is, it’s more probable under this distribution), we accept it and add it to our sample; it is also our new ‘current’ network.</li>
  <li>Otherwise, we might still accept it, deciding randomly based on the ratio between the new and old weights.</li>
</ul>

<p>We repeat this many times, until we decide we have enough samples. The starting network can be any graph – I found that a random network worked well for my relatively small sample sizes, but we can also use the observed network itself, or a completely empty one. In theory, it shouldn’t matter after enough iterations.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">triangle_coeff</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="s">'''
    Use MCMC to generate a sample of networks from an ERG distribution.

    Args:
        G: The observed network, to seed the graph with
        edge_coeff: The coefficient on the number of edges
        triangle_coeff: The coefficient on number of triangles
        n: The number of samples to generate
    Returns:
        A list of graph objects
    '''</span>

    <span class="n">v</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="c1"># number of nodes in G
</span>    <span class="n">p</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">density</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="c1"># Probability of a random edge existing
</span>    <span class="n">current_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="c1"># Random graph
</span>    <span class="n">current_w</span> <span class="o">=</span> <span class="n">compute_weight</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">triangle_coeff</span><span class="p">)</span>
    <span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">graphs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">new_graph</span> <span class="o">=</span> <span class="n">permute_graph</span><span class="p">(</span><span class="n">current_graph</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">compute_weight</span><span class="p">(</span><span class="n">new_graph</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">triangle_coeff</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_w</span> <span class="o">&gt;</span> <span class="n">current_w</span> <span class="ow">or</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">new_w</span><span class="o">/</span><span class="n">current_w</span><span class="p">):</span>
            <span class="n">graphs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>
            <span class="n">current_w</span> <span class="o">=</span> <span class="n">new_w</span>
    <span class="k">return</span> <span class="n">graphs</span>
</code></pre></div></div>

<p>So this code lets us generate a sample of networks from an exponential random graph distribution when we know the coefficients.</p>

<p>However, what we really want to do is find the coefficients. To do this, we want to look for the coefficients that describe an ERG distribution that makes the observed graph as likely as possible.</p>

<h1 id="fitting-the-model">Fitting the model</h1>

<p>The first thing we need to do is calculate the probability of observing any given graph, which means summing the weights of all the graphs in a sample:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sum_weights</span><span class="p">(</span><span class="n">graphs</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">tri_coeff</span><span class="p">):</span>
    <span class="s">'''
    Sum the probability weights on every graph in graphs
    '''</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">graphs</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">compute_weight</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">tri_coeff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</code></pre></div></div>

<p>With this, we can calculate the probability of a given graph by dividing its weight by the sum of all weights from the sample.</p>

<p>Next, we can use our favorite optimization technique to hunt through the space of possible edge and triangle coefficients.</p>

<p>Instead of changing the network, we’ll randomly change the parameters, and use our MCMC function to estimate the probability of getting the observed network at those parameter values.</p>

<p>One simple way to do it uses a similar Metropolis-Hastings approach to the one we used above, with one tweak: early on, we want to try larger jumps around the parameter space; as we get further along, and hopefully closer to the ‘best’ value, the jumps should get smaller and smaller. There’s not really a right way to tweak the jump size</p>

<p>Here’s the code I came up with to do it:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fit_ergm</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">coeff_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">graph_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="s">'''
    Use MCMC to sample possible coefficients, and return the best fits.

    Args:
        G: The observed graph to fit
        coeff_samples: The number of coefficient combinations to sample
        graph_samples: The number of graphs to sample for each set of coeffs
        return_all: If True, return all sampled values. Otherwise, only best.
    Returns:
        If return_all=False, returns a tuple of values,
            (best_edge_coeff, best_triangle_coeff, best_p)
        where p is the estimated probability of observing the graph G with
        the fitted parameters.

        Otherwise, return a tuple of lists:
            (edge_coeffs, triangle_coeffs, probs)
    '''</span>
    <span class="n">edge_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">triangle_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">coeff_samples</span><span class="p">:</span>
        <span class="c1"># Make the jump size larger early on, and smaller toward the end
</span>        <span class="n">w</span> <span class="o">=</span> <span class="n">coeff_samples</span><span class="o">/</span><span class="mf">50.0</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">))</span>
        <span class="c1"># Pick new coefficients to try:
</span>        <span class="n">edge_coeff</span> <span class="o">=</span> <span class="n">edge_coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>  <span class="n">random</span><span class="p">.</span><span class="n">normalvariate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">triangle_coeff</span> <span class="o">=</span> <span class="n">triangle_coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="p">.</span><span class="n">normalvariate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="c1"># Check how likely the observed graph is under this distribution:
</span>        <span class="n">graphs</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">triangle_coeff</span><span class="p">,</span> <span class="n">graph_samples</span><span class="p">)</span>
        <span class="n">sum_weight</span> <span class="o">=</span> <span class="n">sum_weights</span><span class="p">(</span><span class="n">graphs</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">triangle_coeff</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">compute_weight</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_coeff</span><span class="p">,</span> <span class="n">triangle_coeff</span><span class="p">)</span> <span class="o">/</span> <span class="n">sum_weight</span>
        <span class="c1"># Decide whether to accept the jump:
</span>        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">probs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="n">probs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">edge_coeffs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge_coeff</span><span class="p">)</span>
            <span class="n">triangle_coeffs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">triangle_coeff</span><span class="p">)</span>
            <span class="n">probs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edge_coeffs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge_coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">triangle_coeffs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">triangle_coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">probs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Return either the best values, or all of them:
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">return_all</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
        <span class="n">best_p</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">best_edge_coeff</span> <span class="o">=</span> <span class="n">edge_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">best_triangle_coeff</span> <span class="o">=</span> <span class="n">triangle_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">best_edge_coeff</span><span class="p">,</span> <span class="n">best_triangle_coeff</span><span class="p">,</span> <span class="n">best_p</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">edge_coeffs</span><span class="p">,</span> <span class="n">triangle_coeffs</span><span class="p">,</span> <span class="n">probs</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="example-application">Example application</h1>

<p>Now the real test – fitting the ERGM to an actual network. The canonical example is the Florentine marriage network, which is included in NetworkX.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">florentine_families_graph</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nx</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://socrateslab.github.io/forum/assets//img2017/ergm1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">timeit</span>
<span class="n">graphs</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 loop, best of 3: 6.79 s per loop
</code></pre></div></div>

<p>I fit the ERGM with 100 coefficient iterations and 10,000 random networks for each candidate distribution. I also have it return the full series of steps. Note: this part takes a while.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">timeit</span>
<span class="n">edge_coeffs</span><span class="p">,</span> <span class="n">triangle_coeffs</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">fit_ergm</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The slowest run took 25.50 times longer than the fastest. This could mean that an intermediate result is being cached.
10 loops, best of 3: 199 ms per loop
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">edge_coeffs</span><span class="p">,</span> <span class="n">triangle_coeffs</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">fit_ergm</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
<span class="k">print</span> <span class="n">edge_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="k">print</span> <span class="n">triangle_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.59541550664
0.445701809562
-0.492293584485
</code></pre></div></div>

<p>Once it’s done (about 20 minutes later, for me), we can find the values it converged to. For me, they were:</p>

<p>Edge coefficient: -1.667</p>

<p>Triangle coefficient: -0.258</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==========================
Summary of model fit
==========================

Formula:   flomarriage ~ edges + triangles

Iterations:  20

Monte Carlo MLE Results:
         Estimate Std. Error MCMC % p-value    
edges     -1.6773     0.3499      0  &lt;1e-04 ***
triangle   0.1574     0.5831      0   0.788    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Not too far off! The edge coefficient is very close; the triangle coefficient is not too far off, and in any case isn't statistically significant.
</code></pre></div></div>

<p>One problem I discovered is that I obtained some estimated probabilities for the observed network that were greater than 1. This means that the network MCMC was sampling far away from the observed network, so that the weight on the observed network was greater than the sum of weights on all the sampled networks. This isn’t a great outcome, though it still does tell us something about how likely the observed network is under that distribution. Increasing the network sample size might help make this problem go away, as would improving the Markov chain procedure (e.g. with more permutation between networks).</p>

<p>We can do a few more diagnostics on the results. For example, the trace of the value of the coefficients at each iteration is:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">p1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_coeffs</span><span class="p">)</span>
<span class="n">p2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">triangle_coeffs</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"Coefficient value"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Iteration"</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="p">[</span><span class="s">"Edge coefficient"</span><span class="p">,</span> <span class="s">"Triangle coefficient"</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="https://socrateslab.github.io/forum/assets//img2017/ergm2.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">weighted_edge_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">edge_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="k">print</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">weighted_edge_coeffs</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.297715535504
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">weighted_tri_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">triangle_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="k">print</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">weighted_tri_coeffs</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-0.481915973737
</code></pre></div></div>

<p>We can also see the distribution of possible coefficients, by making a histogram weighted by the likelihood we observed for each value. (To deal with the likelihoods estimated at greater than 1, I actually weight each coefficient value by the log of the estimated likelihood).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">edge_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">weights</span><span class="o">=-</span><span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Edge coefficient"</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Coefficient value"</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">triangle_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">weights</span><span class="o">=-</span><span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Triangle coefficient"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Coefficient value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://socrateslab.github.io/forum/assets/img2017/ergm3.png" alt="png" /></p>

<p>This shows that the bulk of the weight on the edge coefficient is between -1 and -2, while the triangle coefficient is much more evenly distributed on both sides of 0. Using a distribution like this, we can statistically test whether the coefficients are significantly different from 0, estimate the standard error, and do various other statistical tests and operations I won’t cover here.</p>

<p>And that’s it! We have a slow, simplistic but apparently somewhat-working ERGM model fitter, built up from scratch.</p>

<p>If you want to learn how to actually do ERGM analysis in R , Benjamin Lind has a great <a href="http://badhessian.org/2012/09/lessons-on-exponential-random-graph-modeling-from-greys-anatomy-hook-ups/">hands-on tutorial</a> over at Bad Hessian on using ERGMs to model the hookup network on the TV show Grey’s Anatomy.</p>

<p>The paper <a href="http://www.jstatsoft.org/v24/i03/paper">introducing the ergm package</a> by Hunter et al., the package developers, is a great guide</p>

<p>as is the (paywalled) <a href="http://www.sciencedirect.com/science/article/pii/S0378873306000372">An introduction to exponential random graph (p*) models for social networks</a> by Robins et al.</p>

<p><a href="http://www.cmu.edu/joss/content/articles/volume3/Snijders.pdf">Markov Chain Monte Carlo Estimation of Exponential Random Graph Models</a> by Tom Snijders goes into more detail on estimation methodology, and includes an appendix with a much better estimation algorithm, which I may try to implement in the future.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://socrateslab.github.io/forum/tags/#ergm" class="page__taxonomy-item" rel="tag">ergm</a><span class="sep">, </span>
    
      
      
      <a href="https://socrateslab.github.io/forum/tags/#python" class="page__taxonomy-item" rel="tag">python</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-06-27T00:00:00+00:00">June 27, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

<!-- needsharebutton Javascript file -->
<script src="/assets/js/needsharebutton.min.js"></script>
<!-- needsharebutton CSS file -->
<link href="/assets/css/needsharebutton.min.css" rel="stylesheet" />

<button  class="btn btn-default need-share-button">Share</button>
  <a href="https://twitter.com/intent/tweet?via=ChengJunWang&text=Implementing+an+ERGM+from+scratch+in+Python%20https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fergm-python%2F" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fergm-python%2F" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fergm-python%2F" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fergm-python%2F" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="https://socrateslab.github.io/forum/ergm-pymc/" class="pagination--pager" title="Estimating ERGM using PyMC
">Previous</a>
    
    
      <a href="https://socrateslab.github.io/forum/pytorch/" class="pagination--pager" title="pytorch初步
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
    
        <h4 class="page__comments-title">Leave a Comment</h4>
        <section id="disqus_thread">
          <a href="#" onclick="disqus();return false;">Show Comments</a>
        </section>
      
</div>

    

    
  </article>


  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/unsplash-gallery-image-4-th.jpg"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/thresholdbook/" rel="permalink">王成军副教授专著《跨越网络的门槛》出版
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">‘信息扩散作为一种普遍存在的现象，在人类生活中扮演着重要角色。伴随着Web2.0的兴起，信息共享网站（Information Sharing Website，ISW）已经成为互联网信息扩散的新平台。信息共享网站通常以社交网络服务（Social Networking Service，SNS）、信息聚合器（infor...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/ugly-duckling/" rel="permalink">寻找真、假新闻中的“丑小鸭”：使用窥视策略预测新闻扩散规模和真实性
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">信息扩散中存在着一些“丑小鸭”类型的信息。“丑小鸭”类型的信息初始阶段就与众不同，一经转发，便可成为网络中的流行信息。
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/unsplash-gallery-image-2-th.jpg"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/douban-group/" rel="permalink">计算传播网迁移至豆瓣小组
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">为了方便维护和更新，计算传播网正式迁移至豆瓣小组。链接为：https://www.douban.com/group/webmining/
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/unsplash-gallery-image-2-th.jpg"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/python/actual-entropy/" rel="permalink">思考真实熵
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">在Limits of Predictability in Human Mobility一文（Song, 2010, Science）当中，Song等人提出人类移动行为的可预测性问题。强调了采用香农熵或随机熵不能捕捉到移动位置的时间序列特点，主张采用一种真实熵(the actual entropy)的测量方式，表示...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/ChengJunWang"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
    
    
    <li><a href="https://socrateslab.github.io/forum/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 计算传播网. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/forum/assets/js/main.min.js"></script>




  
      <script type="text/javascript">
// Replace labnol with your disqus shortname
var disqus_shortname = 'computational-communication';
// Put the permalink of your web page / blog post
var disqus_url = "https://socrateslab.github.io/forum/ergm-python/";
// Put the permalink of your web page / blog post
var disqus_identifier = "/ergm-python";
var disqus_loaded = false;
// This is the function that will load Disqus comments on demand
function disqus() {
  if (!disqus_loaded)  {
    // This is to ensure that Disqus widget is loaded only once
    disqus_loaded = true;
    var e = document.createElement("script");
    e.type = "text/javascript";
    e.async = true;
    e.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (document.getElementsByTagName("head")[0] ||
     document.getElementsByTagName("body")[0])
    .appendChild(e);
  }
}
</script>
<!--


  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'computational-communication';
  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();
  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>

  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <script>
    var disqus_config = function () {
      this.page.url = "https://socrateslab.github.io/forum/ergm-python/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/ergm-python"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://computational-communication.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

-->

    



  </body>
</html>
