<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.6.0 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>使用Boostrap方法为长尾数据计算置信区间 - 计算传播网</title>




<meta name="description" content="A robust way to calculate confidence intervals for machine learning algorithms is to use the bootstrap. This is a general technique for estimating statistics that can be used to calculate empirical confidence intervals, regardless of the distribution of skill scores (e.g. non-Gaussian).">




<meta name="author" content="Jason Brownlee">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="计算传播网">
<meta property="og:title" content="使用Boostrap方法为长尾数据计算置信区间">


  <link rel="canonical" href="https://socrateslab.github.io/forum/confidence-bootstrap-python/">
  <meta property="og:url" content="https://socrateslab.github.io/forum/confidence-bootstrap-python/">



  <meta property="og:description" content="A robust way to calculate confidence intervals for machine learning algorithms is to use the bootstrap. This is a general technique for estimating statistics that can be used to calculate empirical confidence intervals, regardless of the distribution of skill scores (e.g. non-Gaussian).">



  <meta name="twitter:site" content="@ChengJunWang">
  <meta name="twitter:title" content="使用Boostrap方法为长尾数据计算置信区间">
  <meta name="twitter:description" content="A robust way to calculate confidence intervals for machine learning algorithms is to use the bootstrap. This is a general technique for estimating statistics that can be used to calculate empirical confidence intervals, regardless of the distribution of skill scores (e.g. non-Gaussian).">
  <meta name="twitter:url" content="https://socrateslab.github.io/confidence-bootstrap-python/">

  
    <meta name="twitter:card" content="summary">
    
  

  
    <meta name="twitter:creator" content="@Jason Brownlee">
  



  

  



  <meta property="og:image" content="https://socrateslab.github.io/forum/assets/images/unsplash-image-2.jpg">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2018-02-02T00:00:00+00:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "计算传播网",
      "url" : "https://socrateslab.github.io/forum",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://socrateslab.github.io/forum/feed.xml" type="application/atom+xml" rel="alternate" title="计算传播网 Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/forum/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<!--mathjax start-->
    <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         processEscapes: true
       },
      TeX: {
         equationNumbers: { autoNumber: "AMS" }
      }
     });
    </script>
    <script type="text/javascript"
                src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <!--mathjax end-->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="https://socrateslab.github.io/forum/">计算传播网</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io/forum/about/">关于</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io/forum/year-archive/">文章</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io/forum/authors/">作者</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://socrateslab.github.io">中心</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://computational-communication.com/wiki/">百科</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    
  











<div class="page__hero--overlay"
  style="background-color: #000; background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://socrateslab.github.io/forum/assets/images/unsplash-image-2.jpg');"
>
  
    <div class="wrapper">
      <h1 class="page__title" itemprop="headline">
        
          使用Boostrap方法为长尾数据计算置信区间

        
      </h1>
      
        <p class="page__lead">A robust way to calculate confidence intervals for machine learning algorithms is to use the bootstrap. This is a general technique for estimating statistics that can be used to calculate empirical confidence intervals, regardless of the distribution of skill scores (e.g. non-Gaussian).
</p>
      
      
      
    </div>
  
  
    <span class="page__hero-caption">Photo credit: <a href="https://unsplash.com"><strong>Unsplash</strong></a>
</span>
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://socrateslab.github.io/forum/assets/logo.jpg" class="author__avatar" alt="计算传播网" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">计算传播网</h3>
    
      <p class="author__bio" itemprop="description">
        Computational Communication
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Nanjing</span>
        </li>
      

      
        <li>
          <a href="https://computational-communication.com" itemprop="url">
            <i class="fa fa-fw fa-chain" aria-hidden="true"></i> Website
          </a>
        </li>
      

      
        <li>
          <a href="mailto:computational.communication@gmail.com">
            <meta itemprop="email" content="computational.communication@gmail.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.weibo.com/http://weibo.com/p/10080843f915e125a13c116fe1854bc43ccf0a/home" itemprop="sameAs">
            <i class="fa fa-fw fa-weibo" aria-hidden="true"></i> Weibo
          </a>
        </li>
      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="使用Boostrap方法为长尾数据计算置信区间">
    <meta itemprop="description" content="A robust way to calculate confidence intervals for machine learning algorithms is to use the bootstrap. This is a general technique for estimating statistics that can be used to calculate empirical confidence intervals, regardless of the distribution of skill scores (e.g. non-Gaussian).">
    <meta itemprop="datePublished" content="February 02, 2018">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        <h1 id="how-to-calculate-bootstrap-confidence-intervals-for-machine-learning-results-in-python">How to Calculate Bootstrap Confidence Intervals For Machine Learning Results in Python</h1>

<p>by <a href="https://machinelearningmastery.com/author/jasonb/">Jason Brownlee</a> on June 5, 2017 in <a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></p>

<p>It is important to both present the expected skill of a machine learning model as well as confidence intervals for that model skill.</p>

<p>Confidence intervals provide a range of model skills and a likelihood that the model skill will fall between the ranges when making predictions on new data. For example, a 95% likelihood of classification accuracy between 70% and 75%.</p>

<p>A robust way to calculate confidence intervals for machine learning algorithms is to use the bootstrap. This is a general technique for estimating statistics that can be used to calculate empirical confidence intervals, regardless of the distribution of skill scores (e.g. non-Gaussian)</p>

<p>In this post, you will discover how to use the bootstrap to calculate confidence intervals for the performance of your machine learning algorithms.</p>

<p>After reading this post, you will know:</p>

<ul>
  <li>How to estimate confidence intervals of a statistic using the bootstrap.</li>
  <li>How to apply this method to evaluate machine learning algorithms.</li>
  <li>How to implement the bootstrap method for estimating confidence intervals in Python.</li>
</ul>

<p>Let’s get started.</p>

<ul>
  <li><strong>Update June/2017</strong>: Fixed a bug where the wrong values were provided to numpy.percentile(). Thanks Elie Kawerk.</li>
</ul>

<h2 id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals</h2>

<p>Calculating confidence intervals with the bootstrap involves two steps:</p>

<ol>
  <li>Calculate a Population of Statistics</li>
  <li>Calculate Confidence Intervals</li>
</ol>

<h3 id="1-calculate-a-population-of-statistics">1. Calculate a Population of Statistics</h3>

<p>The first step is to use the bootstrap procedure to resample the original data a number of times and calculate the statistic of interest.</p>

<p>The dataset is sampled with replacement. This means that each time an item is selected from the original dataset, it is not removed, allowing that item to possibly be selected again for the sample.</p>

<p>The statistic is calculated on the sample and is stored so that we build up a population of the statistic of interest.</p>

<p>The number of bootstrap repeats defines the variance of the estimate, and more is better, often hundreds or thousands.</p>

<p>We can demonstrate this step with the following pseudocode.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">statistics</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bootstraps</span><span class="p">:</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">select_sample_with_replacement</span><span class="p">(</span><span class="n">data</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="n">calculate_statistic</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">statistics</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2-calculate-confidence-interval">2. Calculate Confidence Interval</h3>

<p>Now that we have a population of the statistics of interest, we can calculate the confidence intervals.</p>

<p>This is done by first ordering the statistics, then selecting values at the chosen percentile for the confidence interval. The chosen percentile in this case is called alpha.</p>

<p>For example, if we were interested in a confidence interval of 95%, then alpha would be 0.95 and we would select the value at the 2.5% percentile as the lower bound and the 97.5% percentile as the upper bound on the statistic of interest.</p>

<p>For example, if we calculated 1,000 statistics from 1,000 bootstrap samples, then the lower bound would be the 25th value and the upper bound would be the 975th value, assuming the list of statistics was ordered.</p>

<p>In this, we are calculating a non-parametric confidence interval that does not make any assumption about the functional form of the distribution of the statistic. This confidence interval is often called the empirical confidence interval.</p>

<p>We can demonstrate this with pseudocode below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ordered</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">statistics</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">percentile</span><span class="p">(</span><span class="n">ordered</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">percentile</span><span class="p">(</span><span class="n">ordered</span><span class="p">,</span> <span class="n">alpha</span><span class="o">+</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="bootstrap-model-performance">Bootstrap Model Performance</h2>

<p>The bootstrap can be used to evaluate the performance of machine learning algorithms.</p>

<p>The size of the sample taken each iteration may be limited to 60% or 80% of the available data. This will mean that there will be some samples that are not included in the sample. These are called out of bag (OOB) samples.</p>

<p>A model can then be trained on the data sample each bootstrap iteration and evaluated on the out of bag samples to give a performance statistic, which can be collected and from which confidence intervals may be calculated.</p>

<p>We can demonstrate this process with the following pseudocode.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">statistics</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bootstraps</span><span class="p">:</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">select_sample_with_replacement</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>	<span class="n">statistics</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="calculate-classification-accuracy-confidence-interval">Calculate Classification Accuracy Confidence Interval</h2>

<p>This section demonstrates how to use the bootstrap to calculate an empirical confidence interval for a machine learning algorithm on a real-world dataset using the Python machine learning library scikit-learn.</p>

<p>This section assumes you have Pandas, NumPy, and Matplotlib installed. If you need help setting up your environment, see the tutorial:</p>

<ul>
  <li><a href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a></li>
</ul>

<p>First, download the <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">Pima Indians dataset</a> and place it in your current working directory with the filename “pima<em>–</em>indians<em>-diabetes.data.csv</em>“.</p>

<p>We will load the dataset using Pandas.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load dataset
</span><span class="n">data</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s">'pima-indians-diabetes.data.csv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<p>Next, we will configure the bootstrap. We will use 1,000 bootstrap iterations and select a sample that is 50% the size of the dataset.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># configure bootstrap
</span><span class="n">n_iterations</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.50</span><span class="p">)</span>
</code></pre></div></div>

<p>Next, we will iterate over the bootstrap.</p>

<p>The sample will be selected with replacement using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.utils.resample.html">resample() function</a> from sklearn. Any rows that were not included in the sample are retrieved and used as the test dataset. Next, a decision tree classifier is fit on the sample and evaluated on the test set, a classification score calculated, and added to a list of scores collected across all the bootstraps.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># run bootstrap
</span><span class="n">stats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>	<span class="c1"># prepare train and test sets
</span>    <span class="n">train</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">n_size</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">train</span><span class="p">.</span><span class="n">tolist</span><span class="p">()])</span>
    <span class="c1"># fit model
</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">train</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># evaluate model
</span>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">test</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>
</code></pre></div></div>

<p>Once the scores are collected, a histogram is created to give an idea of the distribution of scores. We would generally expect this distribution to be Gaussian, perhaps with a skew with a symmetrical variance around the mean.</p>

<p>Finally, we can calculate the empirical confidence intervals using the <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.percentile.html">percentile() NumPy function</a>. A 95% confidence interval is used, so the values at the 2.5 and 97.5 percentiles are selected.</p>

<p>Putting this all together, the complete example is listed below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">resample</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="c1"># load dataset
</span><span class="n">data</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s">'pima-indians-diabetes.data.csv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">values</span>
<span class="c1"># configure bootstrap
</span><span class="n">n_iterations</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.50</span><span class="p">)</span>
<span class="c1"># run bootstrap
</span><span class="n">stats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>
  	<span class="c1"># prepare train and test sets
</span>    <span class="n">train</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">n_size</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">train</span><span class="p">.</span><span class="n">tolist</span><span class="p">()])</span>
    <span class="c1"># fit model
</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">train</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># evaluate model
</span>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">test</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
<span class="c1"># plot scores
</span><span class="n">pyplot</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
<span class="n">pyplot</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># confidence intervals
</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">lower</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">numpy</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="p">((</span><span class="mf">1.0</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">upper</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">numpy</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'%.1f confidence interval %.1f%% and %.1f%%'</span> <span class="o">%</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">lower</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">upper</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</code></pre></div></div>

<p>Running the example prints the classification accuracy each bootstrap iteration.</p>

<p>A histogram of the 1,000 accuracy scores is created showing a Gaussian-like distribution.</p>

<p>Distribution of Classification Accuracy Using the Bootstrap</p>

<p>Finally, the confidence intervals are reported, showing that there is a 95% likelihood that the confidence interval 64.4% and 73.0% covers the true skill of the model.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="p">...</span>
 <span class="mf">0.646288209607</span>
 <span class="mf">0.682203389831</span>
 <span class="mf">0.668085106383</span>
 <span class="mf">0.673728813559</span>
 <span class="mf">0.686021505376</span>
 <span class="mf">95.0</span> <span class="n">confidence</span> <span class="n">interval</span> <span class="mf">64.4</span><span class="o">%</span> <span class="ow">and</span> <span class="mf">73.0</span><span class="o">%</span>
</code></pre></div></div>

<p>This same method can be used to calculate confidence intervals of any other errors scores, such as root mean squared error for regression algorithms.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span><span class="p">;</span>
<span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">color_codes</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">"tips"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"day"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"total_bill"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="https://socrateslab.github.io/forum/assets/img2018/confidence_intervals.png" alt="png" /></p>

<h2 id="further-reading">Further Reading</h2>

<p>This section provides additional resources on the bootstrap and bootstrap confidence intervals.</p>

<ul>
  <li><a href="http://www.amazon.com/dp/0412042312?tag=inspiredalgor-20">An Introduction to the Bootstrap</a>, 1996</li>
  <li><a href="https://projecteuclid.org/download/pdf_1/euclid.ss/1032280214">Bootstrap Confidence Intervals</a>, Statistical Science, 1996</li>
  <li>Section 5.2.3, Bootstrap Confidence Intervals, <a href="http://www.amazon.com/dp/0262032252?tag=inspiredalgor-20">Empirical Methods for Artificial Intelligence</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrapping</a> on Wikipedia</li>
  <li>Section 4.4 Resampling Techniques, <a href="http://www.amazon.com/dp/1461468485?tag=inspiredalgor-20">Applied Predictive Modeling</a></li>
</ul>

<h2 id="summary">Summary</h2>

<p>In this post, you discovered how to use the bootstrap to calculate confidence intervals for machine learning algorithms.</p>

<p>Specifically, you learned:</p>

<ul>
  <li>How to calculate the bootstrap estimate of confidence intervals of a statistic from a dataset.</li>
  <li>How to apply the bootstrap to evaluate machine learning algorithms.</li>
  <li>How to calculate bootstrap confidence intervals for machine learning algorithms in Python.</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-02-02T00:00:00+00:00">February 02, 2018</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

<!-- needsharebutton Javascript file -->
<script src="/assets/js/needsharebutton.min.js"></script>
<!-- needsharebutton CSS file -->
<link href="/assets/css/needsharebutton.min.css" rel="stylesheet" />

<button  class="btn btn-default need-share-button">Share</button>
  <a href="https://twitter.com/intent/tweet?via=ChengJunWang&text=%E4%BD%BF%E7%94%A8Boostrap%E6%96%B9%E6%B3%95%E4%B8%BA%E9%95%BF%E5%B0%BE%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E7%BD%AE%E4%BF%A1%E5%8C%BA%E9%97%B4%20https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fconfidence-bootstrap-python%2F" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fconfidence-bootstrap-python%2F" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fconfidence-bootstrap-python%2F" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fsocrateslab.github.io%2Fforum%2Fconfidence-bootstrap-python%2F" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="https://socrateslab.github.io/forum/network2map/" class="pagination--pager" title="基于泰森多边形的网络可视化
">Previous</a>
    
    
      <a href="https://socrateslab.github.io/forum/python-spatial-vis/" class="pagination--pager" title="使用python可视化地理空间数据
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
    
        <h4 class="page__comments-title">Leave a Comment</h4>
        <section id="disqus_thread">
          <a href="#" onclick="disqus();return false;">Show Comments</a>
        </section>
      
</div>

    

    
  </article>


  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/unsplash-gallery-image-4-th.jpg"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/thresholdbook/" rel="permalink">王成军副教授专著《跨越网络的门槛》出版
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">‘信息扩散作为一种普遍存在的现象，在人类生活中扮演着重要角色。伴随着Web2.0的兴起，信息共享网站（Information Sharing Website，ISW）已经成为互联网信息扩散的新平台。信息共享网站通常以社交网络服务（Social Networking Service，SNS）、信息聚合器（infor...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/ugly-duckling/" rel="permalink">寻找真、假新闻中的“丑小鸭”：使用窥视策略预测新闻扩散规模和真实性
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">信息扩散中存在着一些“丑小鸭”类型的信息。“丑小鸭”类型的信息初始阶段就与众不同，一经转发，便可成为网络中的流行信息。
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/unsplash-gallery-image-2-th.jpg"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/douban-group/" rel="permalink">计算传播网迁移至豆瓣小组
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">为了方便维护和更新，计算传播网正式迁移至豆瓣小组。链接为：https://www.douban.com/group/webmining/
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/unsplash-gallery-image-2-th.jpg"
          
          alt="">
      </div>
    
    
    <h2 class="archive__item-title" itemprop="headline">
      <a href="/forum/python/actual-entropy/" rel="permalink">思考真实熵
</a>
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">在Limits of Predictability in Human Mobility一文（Song, 2010, Science）当中，Song等人提出人类移动行为的可预测性问题。强调了采用香农熵或随机熵不能捕捉到移动位置的时间序列特点，主张采用一种真实熵(the actual entropy)的测量方式，表示...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/ChengJunWang"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
    
    
    <li><a href="https://socrateslab.github.io/forum/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 计算传播网. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/forum/assets/js/main.min.js"></script>




  
      <script type="text/javascript">
// Replace labnol with your disqus shortname
var disqus_shortname = 'computational-communication';
// Put the permalink of your web page / blog post
var disqus_url = "https://socrateslab.github.io/forum/confidence-bootstrap-python/";
// Put the permalink of your web page / blog post
var disqus_identifier = "/confidence-bootstrap-python";
var disqus_loaded = false;
// This is the function that will load Disqus comments on demand
function disqus() {
  if (!disqus_loaded)  {
    // This is to ensure that Disqus widget is loaded only once
    disqus_loaded = true;
    var e = document.createElement("script");
    e.type = "text/javascript";
    e.async = true;
    e.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (document.getElementsByTagName("head")[0] ||
     document.getElementsByTagName("body")[0])
    .appendChild(e);
  }
}
</script>
<!--


  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'computational-communication';
  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();
  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>

  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <script>
    var disqus_config = function () {
      this.page.url = "https://socrateslab.github.io/forum/confidence-bootstrap-python/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/confidence-bootstrap-python"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://computational-communication.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

-->

    



  </body>
</html>
